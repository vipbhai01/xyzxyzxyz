const demoSource = 'https://devstreaming-cdn.apple.com/videos/streaming/examples/img_bipbop_adv_example_ts/master.m3u8';

  const config = {
    parentId: "#player",
    plugins: [LevelSelector],
    autoPlay: true,
    width: '100%',
    height: '100%',
  }

  const player = new Clappr.Player(config);

  $("#playBtn").click(function(e) {
    const source = document.getElementById('url').value;
    if(!source.startsWith('https')) {
      M.toast({html: 'URL must start with https, we care about security ðŸ˜œ', displayLength: 2000})
      e.preventDefault();
      return;
    }
    updateSource(source);
  });

  $(".demoVideo").click(function(e) {
    updateSource();
    return false;
  });

  function updateSource(source = demoSource) {
    player.configure({ source });
    resizePlayer();
  }

  function resizePlayer(){
    const aspectRatio = 9/16;
    const newWidth = document.getElementById('player')
      ? document.getElementById('player').parentElement.offsetWidth
      : 0;
    const newHeight = 2 * Math.round(newWidth * aspectRatio/2);
    if(player._ready) {
      player.resize({width: newWidth, height: newHeight});
    }   
  }
  window.onresize = resizePlayer; 